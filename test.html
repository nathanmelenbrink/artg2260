<!doctype html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>ARTG2260: Programming Basics</title>
<meta name="description" content="Index Page">
<script src="../js/vendor/jquery.min.js"></script>



<link href="../css/style.css" rel="stylesheet">
<link href="../css/font-awesome.min.css" rel="stylesheet">
<script src="../js/vendor/modernizr.js"></script>
<script src="../js/p5.min.js"></script>
</head>
<body>

<div id = 'sketch-holder'></div>
<script>

let gameState = 0;
let score = 0;
let poacher;
let a;
let bullets = [];
let time;


function setup(){
  framerate = 30;
  var cnv = createCanvas(600,400);
  cnv.parent('sketch-holder');
  poacher = new Poacher();
}

function draw(){
  background(255);
  if (gameState == 0){
    startScreen();
  } else if (gameState == 1){
    update();
  } else if (gameState == 2){
    gameOver();
  }
  poacher.display();
  poacher.move();
  for (b of bullets) {
    b.move();
    b.display();
    //print("bullet comes!");
  }
  time = frameCount % frameRate;
}

function mouseClicked(){
   if (gameState == 0){
     gameState = 1;
   } else if (gameState == 2){
     gameState = 0;
   } else if (gameState == 1){
     poacher.shoot();
   }
  }

function startScreen() {
  background(255);
  text("click to begin", 10, 30);
}

function update() {
  background(255);
  score++;
  text("playing", 10, 30);
  text("score: " + score, 400, 30);
}

function gameOver(){
  if (gameState == 0){
    gameState = 1;
  } else if (gameState == 2){
    gameState = 0;
  }
}


class Poacher {

  constructor(){
    this.x = width/2;
    this.y = height/2;
    this.diameter = 20;
    this.regX = this.x;
    this.regY = this.y;
    this.a = 0;
  }

  display(){
 // put a conditional for a -> only in game state 1
    push();
    this.a = Math.atan2(mouseY - this.y, mouseX - this.x);
    translate(this.x, this.y);
    rotate(this.a);
    beginShape();
    ellipse(0, 0, this.diameter, this.diameter);
    line(0, 0, this.diameter, 0);
    endShape();
    pop();
  }

  move(){
      if(keyIsDown(87)) {
          this.y-=3;

      } if (keyIsDown(83)) {
          this.y+=3;

      } if(keyIsDown(65)){
          this.x-=3;

      } if(keyIsDown(68)) {
          this.x+=3;

      }
    }

    shoot(){
      let bullet = new Bullet(this.a, this.x, this.y);
      bullets.push (bullet);
    }

  }

class Bullet {
  constructor(_a, _x, _y){
    this.x = _x;
    this.y = _y;
    this.diameter = 5;
    this.a = _a;
  }

  display(){
    fill(0);
    ellipse(this.x, this.y, this.diameter, this.diameter);
  }

  move(){
    this.x += 6*cos(this.a);
    this.y += 6*sin(this.a);
  }
}

class Unicorn {
  constructor(){
    this.x = random(0||width);
    this.y = random(height);
    this.diameter = 20;
  }

  display(){
    fill(100,100,100);
    ellipse(this.x, this.y, this.diameter, this.diameter);
  }

  move(){
    if(this.x == 0){
      x+= 4;
    } else if(this.x == wifth){
      x-= 4;
    }
  }
}
</script>
</body>
</html>
